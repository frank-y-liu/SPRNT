      SUBROUTINE BSRL(S,CENTER,HWIDTH,F,MAXVLS,FUNCLS,
     *                  ERRMIN,ERREST,BASEST,DIVAXO,DIVAXN)
      EXTERNAL F
      INTEGER S, DIVAXN, DIVAXO, FUNCLS, INTCLS, I, MINDEG, MAXDEG,
     * MAXORD, MINORD, MAXCLS
      REAL ONE, TWO, THREE, FIVE, TEN, DIF, ERRORM, ERRMIN,
     * CENTER(S), HWIDTH(S), SUM0, SUM1, SUM2, DIFMAX, X1, X2,
     * INTVLS(20), Z(20), FULSMS(200), WEGHTS(200), ERREST, BASEST
      MAXDEG = 12
      MINDEG = 4
      MINORD = 0
      ZERO = 0
      ONE = 1
      TWO = 2
      THREE = 3
      FIVE = 5
      TEN = 10
      DO 10 MAXORD = MINDEG,MAXDEG
        CALL SYMRL(S, CENTER, HWIDTH, F, MINORD, MAXORD, INTVLS,
     *   INTCLS, 200, WEGHTS, FULSMS, IFAIL)
        IF (IFAIL.EQ.2) GOTO 20
        ERREST = ABS(INTVLS(MAXORD)-INTVLS(MAXORD-1))
        ERRORM = ABS(INTVLS(MAXORD-1)-INTVLS(MAXORD-2))
        IF (ERREST.NE.ZERO)
     *  ERREST = ERREST*AMAX1(ONE/TEN,ERREST/AMAX1(ERREST/TWO,ERRORM))
        IF (ERRORM.LE.FIVE*ERREST) GOTO 20
        IF (2*INTCLS.GT.MAXVLS) GOTO 20
        IF (ERREST.LT.ERRMIN) GOTO 20
   10   CONTINUE
   20 DIFMAX = -1
      X1 = ONE/TWO**2
      X2 = THREE*X1
      DO 30 I = 1,S
       Z(I) = CENTER(I)
   30  CONTINUE
      SUM0 = F(S,Z)
      DO 40 I = 1,S
       Z(I) = CENTER(I) - X1*HWIDTH(I)
       SUM1 = F(S,Z)
       Z(I) = CENTER(I) + X1*HWIDTH(I)
       SUM1 = SUM1 + F(S,Z)
       Z(I) = CENTER(I) - X2*HWIDTH(I)
       SUM2 = F(S,Z)
       Z(I) = CENTER(I) + X2*HWIDTH(I)
       SUM2 = SUM2 + F(S,Z)
       Z(I) = CENTER(I)
       DIF = ABS((SUM1-TWO*SUM0) - (X1/X2)**2*(SUM2-TWO*SUM0))
       IF (DIF.LT.DIFMAX) GOTO 40
        DIFMAX = DIF
        DIVAXN = I
   40  CONTINUE
       IF (SUM0.EQ.SUM0+DIFMAX/TWO) DIVAXN = MOD(DIVAXO,S) + 1
      BASEST = INTVLS(MINORD)
      FUNCLS = INTCLS + 4*S
      RETURN
      END
