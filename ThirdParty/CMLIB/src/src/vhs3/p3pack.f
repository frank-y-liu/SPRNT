      SUBROUTINE P3PACK(F,LDIMF,MDIMF,L,M,N,G)
C
C     PACKAGE PSTG3D, VERSION 1, AUGUST 1985
C
      DIMENSION F(LDIMF*MDIMF*N),G(L,M,N)
C
C      THIS SUBROUTINE PACKS THE SUB-ARRAY F(I,J,K), I=1,...,L,
C      J=1,...,M, AND K=1,...,N, INTO THE ARRAY G.
C
      DO 100 K=1,N
      DO 100 J=1,M
      DO 100 I=1,L
  100 G(I,J,K)=F(LDIMF*(MDIMF*(K-1)+J-1)+I)
      IF=LDIMF*(MDIMF*(N-1)+M-1)+LDIMF
      DO 600 K=N,1,-1
      IF (K.EQ.N) GO TO 350
      DO 200 J=MDIMF,M+1,-1
      IF=IF-LDIMF
      DO 200 I=LDIMF,1,-1
  200 F(IF+I)=F(LDIMF*(MDIMF*(K-1)+J-1)+I)
  350 CONTINUE
      DO 400 J=M,1,-1
      IF=IF-(LDIMF-L)
      DO 400 I=LDIMF,L+1,-1
  400 F(IF+I-L)=F(LDIMF*(MDIMF*(K-1)+J-1)+I)
  600 CONTINUE
      RETURN
      END
