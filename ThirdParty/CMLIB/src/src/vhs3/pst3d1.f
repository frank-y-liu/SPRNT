      SUBROUTINE PST3D1(L,M,MP,N,NP,F,
     1                  CFY,CFZ,FT,A,C,FCTRD,WSAVEY,WSAVEZ)
C
C     PACKAGE PSTG3D, VERSION 1, AUGUST 1985
C
      DIMENSION A(L),C(L),F(L,M,N),CFY(4*M),CFZ(4*N),FT(L,M,N),
     1          FCTRD(M,L,N),WSAVEY(M+15),WSAVEZ(N+15)
      IFWRD=1
  100 CONTINUE
C
C     TRANSFORM Y
C
      GO TO (205,220,235,240,255),MP
  205 GO TO (210,215),IFWRD
  210 CALL VSRFTF(F,L,M,N,FT,WSAVEY)
      GO TO 300
  215 CALL VSRFTB(F,L,M,N,FT,WSAVEY)
      GO TO 300
  220 GO TO (225,230),IFWRD
  225 CALL VSSINF(F,L,M,N,FT,CFY(1),CFY(M+1),WSAVEY)
      GO TO 300
  230 CALL VSSINB(F,L,M,N,FT,CFY(1),CFY(M+1),WSAVEY)
      GO TO 300
  235 CALL VSSINQ(F,L,M,N,FT,CFY(1),CFY(M+1),CFY(2*M+1),CFY(3*M+1),
     1            WSAVEY)
      GO TO 300
  240 GO TO (245,250),IFWRD
  245 CALL VSCOSF(F,L,M,N,FT,CFY(1),CFY(M+1),WSAVEY)
      GO TO 300
  250 CALL VSCOSB(F,L,M,N,FT,CFY(1),CFY(M+1),WSAVEY)
      GO TO 300
  255 CALL VSCOSQ(F,L,M,N,FT,CFY(1),CFY(M+1),CFY(2*M+1),CFY(3*M+1),
     1            WSAVEY)
  300 CONTINUE
C
C     TRANSFORM IN Z
C
      GO TO (305,320,335,340,355),NP
  305 GO TO (310,315),IFWRD
  310 CALL VSRFTF(F,L,N,M,FT,WSAVEZ)
      GO TO 400
  315 CALL VSRFTB(F,L,N,M,FT,WSAVEZ)
      GO TO 400
  320 GO TO (325,330),IFWRD
  325 CALL VSSINF(F,L,N,M,FT,CFZ(1),CFZ(N+1),WSAVEZ)
      GO TO 400
  330 CALL VSSINB(F,L,N,M,FT,CFZ(1),CFZ(N+1),WSAVEZ)
      GO TO 400
  335 CALL VSSINQ(F,L,N,M,FT,CFZ(1),CFZ(N+1),CFZ(2*N+1),CFZ(3*N+1),
     1            WSAVEZ)
      GO TO 400
  340 GO TO (345,350),IFWRD
  345 CALL VSCOSF(F,L,N,M,FT,CFZ(1),CFZ(N+1),WSAVEZ)
      GO TO 400
  350 CALL VSCOSB(F,L,N,M,FT,CFZ(1),CFZ(N+1),WSAVEZ)
      GO TO 400
  355 CALL VSCOSQ(F,L,N,M,FT,CFZ(1),CFZ(N+1),CFZ(2*N+1),CFZ(3*N+1),
     1            WSAVEZ)
  400 CONTINUE
      IF (IFWRD.NE.1) GO TO 900
C
C     SOLVE TRIDIAGONAL SYSTEMS (PREVIOUSLY FACTORED IN PST3DI) IN X
C
C        FORWARD SUBSTITUTION
C
      DO 410 K=1,N
      DO 410 J=1,M
  410 F(1,J,K)=F(1,J,K)*FCTRD(J,1,K)
      DO 420 I=2,L
      DO 420 K=1,N
      DO 420 J=1,M
  420 F(I,J,K)=(F(I,J,K)-A(I)*F(I-1,J,K))*FCTRD(J,I,K)
C
C        BACKWARD SUBSTITUTION
C
      DO 430 I=L-1,1,-1
      DO 430 K=1,N
      DO 430 J=1,M
  430 F(I,J,K)=F(I,J,K)-C(I)*FCTRD(J,I,K)*F(I+1,J,K)
      IFWRD=2
      GO TO 100
  900 CONTINUE
      RETURN
      END
