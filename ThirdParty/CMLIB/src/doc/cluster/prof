 
      SUBROUTINE PROF(MM, M, N, A, CLAB, RLAB, TITLE, WORK1, DMWRK2,
     *                WORK2, IERR, OUNIT)
C
C<><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>
C
C   PURPOSE
C   -------
C
C      COMPUTES AND OUTPUTS PROFILES OF THE VARIABLES SUCH THAT THE
C      LINEAR REGRESSION LINES THROUGH EACH CASE HAVE THE SMALLEST
C      TOTAL ERROR
C
C   DESCRIPTION
C   -----------
C
C   1.  THE VARIABLES SHOULD BE SCALED SIMILARLY (CLUSTER SUBROUTINE
C       STAND CAN BE USED TO STANDARDIZE THE VARIABLES).
C
C   2.  THE EIGENVECTORS OF THE A'A MATRIX ARE DETERMINED AND THE
C       LARGEST TWO ARE USED TO MAKE THE LINES CONNECTING EACH CASE FOR
C       ALL VARIABLES AS SMOOTH AS POSSIBLE.
C
C   3.  THE HORIZONTAL LOCATION OF THE PROFILE IS FOUND USING THE
C       RATIOS OF THE VALUES IN THE FIRST TWO EIGENVECTORS.  THE
C       VERTICAL SCALE OF THE PROFILE IS FOUND BY MULTIPLYING THE DATA
C       VALUE BY THE RECIPROCALS OF THE VALUES IN THE FIRST
C       EIGENVECTOR.
C
C       IN OTHER WORDS, A(I,J) IS PLOTTED AT (XLOC, YLOC), WHERE
C
C          XLOC = EIGENVECTOR(J,2) / EIGENVECTOR(J,1)
C       AND
C          YLOC = A(I,J) / EIGENVECTOR(J,1)
C
C       WHERE EIGENVECTOR IS THE MATRIX WHOSE COLUMNS ARE THE TWO
C          LARGEST EIGENVECTORS
C
C   4.  IF TWO PROFILES HAVE THE SAME XLOC VALUE, THE PROFILE THAT IS
C       PLOTTED AT THAT XLOC VALUE WILL BE THE UNION OF THE TWO
C       PROFILES.  THEREFORE, TWO INSTANCES OF THE SAME CASE COULD BE
C       PLOTTED ON THAT PROFILE.  SINCE THE MAXIMUM NUMBER OF PROFILES
C       THAT CAN BE PLOTTED IN A SINGLE CALL IS 25, THIS ROUTINE IS NOT
C       RECOMMEMDED FOR A LARGE NUMBER OF VARIABLES.
C
C   5.  IF TWO CASES ARE TO BE PLOTTED IN THE SAME POSITION ON A
C       PARTICULAR PROFILE, THE SECOND CASE IS PLOTTED AND THE FIRST
C       CASE IS IGNORED.  THEREFORE, IF A PROFILE IS MISSING SOME
C       CASES, THE DATA SHOULD BE ANALYZED TO LOCATE "VERY CLOSE" CASES
C       IN ORDER TO DETERMINE THE APPROXIMATE POSITION OF THE MISSING
C       CASES.  THE PROFILES ARE WRITTEN ON FORTRAN UNIT OUNIT.
C
C   6.  TO OBTAIN A PROFILE OF THE VARIABLES FOR EACH CASE, SEE CLUSTER
C       SUBROUTINE LINE.
C
C   INPUT PARAMETERS
C   ----------------
C
C   MM    INTEGER SCALAR (UNCHANGED ON OUTPUT).
C         THE FIRST DIMENSION OF THE MATRIX A.  MUST BE AT LEAST M.
C
C   M     INTEGER SCALAR (UNCHANGED ON OUTPUT).
C         THE NUMBER OF CASES.
C
C   N     INTEGER SCALAR (UNCHANGED ON OUTPUT).
C         THE NUMBER OF VARIABLES.
C
C   A     REAL MATRIX WHOSE FIRST DIMENSION MUST BE MM AND WHOSE SECOND
C            DIMENSION MUST BE AT LEAST N (UNCHANGED ON OUTPUT).
C         THE MATRIX OF DATA VALUES.
C
C         A(I,J) IS THE VALUE FOR THE J-TH VARIABLE FOR THE I-TH CASE.
C
C   CLAB  VECTOR OF 4-CHARACTER VARIABLES DIMENSIONED AT LEAST N.
C            (UNCHANGED ON OUTPUT).
C         THE LABELS OF THE VARIABLES.
C
C   RLAB  VECTOR OF 4-CHARACTER VARIABLES DIMENSIONED AT LEAST M.
C            (UNCHANGED ON OUTPUT).
C         THE LABELS OF THE CASES.
C
C   TITLE 10-CHARACTER VARIABLE (UNCHANGED ON OUTPUT).
C         TITLE OF THE DATA SET.
C
C   WORK1 REAL VECTOR DIMENSIONED AT LEAST 5*N.
C         WORK VECTOR
C
C   DMWRK2 INTEGER SCALAR (UNCHANGED ON OUTPUT).
C         THE FIRST DIMENSION OF THE MATRIX WORK2.  MUST BE AT LEAST N.
C
C   WORK2 REAL MATRIX WHOSE FIRST DIMENSION MUST BE DMWRK2 AND WHOSE
C            SECOND DIMENSION MUST BE AT LEAST N.
C         WORK MATRIX.
C
C   OUNIT INTEGER SCALAR (UNCHANGED ON OUTPUT).
C         UNIT NUMBER FOR OUTPUT.
C
C   OUTPUT PARAMETER
C   ----------------
C
C   IERR  INTEGER SCALAR.
C         ERROR FLAG.
C
C         IERR = 0, NO ERRORS WERE DETECTED DURING EXECUTION
C
C         IERR = K, CONVERGENCE WAS NOT OBTAINED DURING COMPUTATION OF
C                   EIGENVALUES.  EIGENVALUES 1, ..., K-1 ARE CORRECT.
C                   ERROR FLAG FROM CMLIB SUBROUTINE SSIEV.  EXECUTION
C                   IS TERMINATED.
C
C   REFERENCE
C   ---------
C
C     HARTIGAN, J. A. (1975).  CLUSTERING ALGORITHMS, JOHN WILEY &
C        SONS, INC., NEW YORK.  PAGES 28-32, 42.
C
C<><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>
C
 
 
