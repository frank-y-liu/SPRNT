 
      SUBROUTINE LETREE(MM, M, N, A, RLAB, KC, NT, TH, CWORK, DMIWRK,
     *                  IWORK, IERR, OUNIT)
C
C<><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>
C
C   PURPOSE
C   -------
C
C      USES A LEADER CLUSTERING ALGORITHM TO CONSTRUCT A TREE WHOSE
C      LEVELS ARE DETERMINED BY USER-DEFINED THRESHOLDS
C
C   DESCRIPTION
C   -----------
C
C   1.  THE TREE-LEADER ALGORITHM FOUND ON PAGES 169-176 OF THE FIRST
C       REFERENCE IS IMPLEMENTED.  THE VARIABLES SHOULD BE SCALED
C       SIMILARLY (SUBROUTINE STAND CAN BE USED TO STANDARDIZE THE
C       VARIABLES).
C
C   2.  THE THRESHOLDS REPRESENT THE LARGEST DISTANCES BETWEEN AN
C       OBSERVATION AND ITS CLUSTER LEADER.  THE THRESHOLDS MUST BE
C       INPUT IN DECREASING ORDER.
C
C   3.  THE FINAL TREE WILL BE PRINTED ON FORTRAN UNIT OUNIT.  THE
C       CLUSTERS CORRESPONDING TO THE SMALLEST THRESHOLD ARE THE
C       LEFT-MOST COLUMNS; THE CLUSTERS CORRESPONDING TO THE NEXT
C       SMALLEST THRESHOLD ARE THE NEXT SET OF COLUMNS; ETC.  THE
C       COMMAS AND QUOTE MARKS SEPARATE THE COLUMNS FOR EACH THRESHOLD.
C       THE HORIZONTAL LINES SHOW THE CLUSTER BOUNDARIES AND THE BLANK
C       SPACE BETWEEN THE LINES SHOW THE CASES THAT BELONG TO THE
C       CLUSTERS.
C
C   INPUT PARAMETERS
C   ----------------
C
C   MM    INTEGER SCALAR (UNCHANGED ON OUTPUT).
C         THE LEADING DIMENSION OF THE MATRIX A.  MUST BE AT LEAST M.
C
C   M     INTEGER SCALAR (UNCHANGED ON OUTPUT).
C         THE NUMBER OF CASES.
C
C   N     INTEGER SCALAR (UNCHANGED ON OUTPUT).
C         THE NUMBER OF VARIABLES.
C
C   A     REAL MATRIX WHOSE FIRST DIMENSION MUST BE MM AND SECOND
C            DIMENSION MUST BE AT LEAST N (UNCHANGED ON OUTPUT).
C         THE DATA MATRIX.
C
C         A(I,J) IS THE VALUE FOR THE J-TH VARIABLE FOR THE I-TH CASE.
C
C   RLAB  VECTOR OF 4-CHARACTER VARIABLES DIMENSIONED AT LEAST M
C            (UNCHANGED ON OUTPUT).
C         THE LABELS OF THE VARIABLES.
C
C   KC    INTEGER SCALAR (UNCHANGED ON OUTPUT).
C         THE MAXIMUM NUMBER OF NODES ALLOCATED.  KC SHOULD BE THE
C         SECOND DIMENSION OF THE MATRIX IWORK.  IF KC IS NOT LARGE
C         ENOUGH, A MESSAGE WILL BE PRINTED OUT AND THE ROUTINE WILL
C         STOP.  A GOOD GUESS FOR KC IS (M*M/2).
C
C   NT    INTEGER SCALAR (UNCHANGED ON OUTPUT).
C         THE NUMBER OF THRESHOLDS.
C
C   TH    REAL VECTOR DIMENSIONED AT LEAST NT (UNCHANGED ON OUTPUT).
C         VECTOR OF THRESHOLD VALUES (MUST BE IN DECREASING ORDER!!!!).
C
C   CWORK VECTOR OF 4-CHARACTER VARIABLES DIMENSIONED AT LEAST 2*KC
C         WORK VECTOR.
C
C   DMIWRK INTEGER SCALAR (UNCHANGED ON OUTPUT).
C         THE LEADING DIMENSION OF THE MATRIX IWORK. MUST BE AT LEAST 6.
C
C   IWORK INTEGER MATRIX WHOSE FIRST DIMENSION MUST BE DMIWRK AND WHOSE
C            SECOND DIMENSION MUST BE AT LEAST KC.
C         WORK MATRIX.
C
C   OUNIT INTEGER SCALAR (UNCHANGED ON OUTPUT).
C         UNIT NUMBER FOR OUTPUT.
C
C   OUTPUT PARAMETER
C   ----------------
C
C   IERR  INTEGER SCALAR.
C         ERROR FLAG.
C
C         IERR = 0, NO ERRORS WERE DETECTED DURING EXECUTION
C
C         IERR = 1, EITHER THE FIRST AND LAST CASES OR THE CLUSTER
C                   DIAMETER FOR A CLUSTER IS OUT OF BOUNDS.  THE
C                   CLUSTER AND ITS VALUES ARE PRINTED ON UNIT OUNIT.
C                   EXECUTION WILL CONTINUE WITH QUESTIONABLE RESULTS
C                   FOR THAT CLUSTER.
C
C         IERR = 2, THE MAXIMUM NUMBER OF NODES IS TOO SMALL.
C                   EXECUTION IS TERMINATED.  THE VALUE OF KC
C                   SHOULD BE INCREASED.
C
C   REFERENCES
C   ----------
C
C     HARTIGAN, J. A. (1975).  CLUSTERING ALGORITHMS, JOHN WILEY &
C        SONS, INC., NEW YORK.  PAGES 169-176.
C
C     HARTIGAN, J. A. (1975) PRINTER GRAPHICS FOR CLUSTERING. JOURNAL OF
C        STATISTICAL COMPUTATION AND SIMULATION. VOLUME 4,PAGES 187-213.
C
C<><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><><>
C
 
 
